<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Menopause Macro Calculator</title>
  <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(135deg, #fdf6f0 0%, #f5ebe0 50%, #ede0d4 100%);
      min-height: 100vh;
      font-family: 'Libre Baskerville', serif;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(16px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .fade-in { animation: fadeIn 0.4s ease; }
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; }
    input[type=number] { -moz-appearance: textfield; }
    button { transition: all 0.2s; }
  </style>
</head>
<body>
<div id="root"></div>
<script>
(function () {
  var e = React.createElement;
  var useState = React.useState;

  var ACTIVITY = [
    { label: "Lightly Active",    desc: "Walking, gentle yoga, light movement most days",    mult: 1.375, ck: 3.0 },
    { label: "Moderately Active", desc: "Strength training or cardio 3 to 4 times per week", mult: 1.55,  ck: 4.0 },
    { label: "Very Active",       desc: "Daily intense training, CrossFit, endurance sport",  mult: 1.725, ck: 5.5 },
  ];

  var STAGES = [
    { label: "Perimenopause",             desc: "Still cycling but irregularly (typically 40s to early 50s)", pm: 2.0 },
    { label: "Menopause / Postmenopause", desc: "12 or more months without a period",                        pm: 2.2 },
  ];

  var cardStyle = {
    background:"white", borderRadius:"24px", padding:"28px",
    boxShadow:"0 8px 40px rgba(100,60,30,0.10)", marginBottom:"20px"
  };
  var inputStyle = {
    width:"100%", padding:"12px 14px", borderRadius:"12px",
    border:"2px solid #e8ddd6", fontSize:"15px",
    fontFamily:"'Libre Baskerville', serif", color:"#3d2c24",
    background:"white", outline:"none", boxSizing:"border-box"
  };
  var lblStyle = {
    fontSize:"13px", color:"#7a6a5e", marginBottom:"6px",
    display:"block", fontStyle:"italic"
  };

  /* ── RangeBar ── */
  function RangeBar(props) {
    var pct = Math.min(100, Math.max(0, ((props.value - props.min) / (props.max - props.min)) * 100));
    return e("div", { style:{ marginBottom:"10px" } },
      e("div", { style:{ display:"flex", justifyContent:"space-between", marginBottom:"4px" } },
        e("span", { style:{ fontSize:"13px", color:"#6b5a4e" } }, props.label),
        e("span", { style:{ fontSize:"13px", fontWeight:"700", color:"#3d2c24" } }, Math.round(props.value) + props.unit)
      ),
      e("div", { style:{ height:"8px", borderRadius:"4px", background:"#e8ddd6", overflow:"hidden" } },
        e("div", { style:{ height:"100%", width:pct+"%", background:props.color, borderRadius:"4px", transition:"width 0.5s ease" } })
      ),
      e("div", { style:{ display:"flex", justifyContent:"space-between", marginTop:"3px" } },
        e("span", { style:{ fontSize:"11px", color:"#a08070" } }, props.min + props.unit),
        e("span", { style:{ fontSize:"11px", color:"#a08070" } }, props.max + props.unit)
      )
    );
  }

  /* ── MacroCard ── */
  function MacroCard(props) {
    var open = useState(false);
    var isOpen = open[0];
    var setOpen = open[1];

    return e("div", {
      onClick: function() { setOpen(!isOpen); },
      style:{
        background:"white", borderRadius:"16px", padding:"18px 20px", cursor:"pointer",
        border:"2px solid " + (isOpen ? props.color : "#f0e8e0"),
        transition:"all 0.3s ease",
        boxShadow: isOpen ? "0 4px 20px " + props.color + "40" : "0 2px 8px rgba(0,0,0,0.05)"
      }
    },
      e("div", { style:{ display:"flex", justifyContent:"space-between", alignItems:"center" } },
        e("div", { style:{ display:"flex", alignItems:"center", gap:"10px" } },
          e("div", { style:{ width:"40px", height:"40px", borderRadius:"12px", background:props.color+"20",
              display:"flex", alignItems:"center", justifyContent:"center", fontSize:"20px" } }, props.emoji),
          e("div", null,
            e("div", { style:{ fontWeight:"700", color:"#3d2c24", fontSize:"16px" } }, props.label),
            e("div", { style:{ fontSize:"12px", color:"#a08070" } }, props.pct + "% of calories")
          )
        ),
        e("div", { style:{ textAlign:"right" } },
          e("div", { style:{ fontWeight:"700", color:props.color, fontSize:"22px" } }, Math.round(props.grams) + "g"),
          e("div", { style:{ fontSize:"12px", color:"#a08070" } }, Math.round(props.calories) + " kcal")
        )
      ),
      isOpen && e("div", { style:{ marginTop:"14px", borderTop:"1px solid #f0e8e0", paddingTop:"12px" } },
        e("div", { style:{ fontSize:"12px", color:"#7a6a5e", marginBottom:"8px", fontStyle:"italic" } }, "Suggested per-meal distribution"),
        props.meals.map(function(m, i) {
          return e("div", { key:i, style:{
            display:"flex", justifyContent:"space-between", padding:"6px 0",
            borderBottom: i < props.meals.length - 1 ? "1px solid #f8f4f0" : "none"
          }},
            e("span", { style:{ fontSize:"13px", color:"#6b5a4e" } }, m.meal),
            e("span", { style:{ fontSize:"13px", fontWeight:"600", color:"#3d2c24" } }, m.amount + "g")
          );
        }),
        props.note && e("div", { style:{
          marginTop:"10px", padding:"10px", background:props.color+"12",
          borderRadius:"10px", fontSize:"12px", color:"#6b5a4e", lineHeight:"1.6"
        }}, props.note)
      ),
      e("div", { style:{ marginTop:"10px", textAlign:"center", fontSize:"11px", color:"#c0a090" } },
        isOpen ? "tap to close" : "tap for meal breakdown")
    );
  }

  /* ── SelectOption ── */
  function SelectOption(props) {
    return e("div", {
      onClick: props.onClick,
      style:{
        padding:"12px 16px", borderRadius:"12px", cursor:"pointer",
        border:"2px solid " + (props.selected ? props.accent : "#e8ddd6"),
        background: props.selected ? props.accent + "18" : "white",
        transition:"all 0.2s"
      }
    },
      e("div", { style:{ fontWeight:"700", fontSize:"14px", color: props.selected ? props.accent : "#3d2c24" } }, props.label),
      e("div", { style:{ fontSize:"12px", color:"#a08070", marginTop:"2px" } }, props.desc)
    );
  }

  /* ── App ── */
  function App() {
    var unitState    = useState("imperial"); var unit = unitState[0]; var setUnit = unitState[1];
    var weightState  = useState(""); var weight = weightState[0]; var setWeight = weightState[1];
    var hFtState     = useState(""); var hFt = hFtState[0]; var setHFt = hFtState[1];
    var hInState     = useState(""); var hIn = hInState[0]; var setHIn = hInState[1];
    var hCmState     = useState(""); var hCm = hCmState[0]; var setHCm = hCmState[1];
    var ageState     = useState(""); var age = ageState[0]; var setAge = ageState[1];
    var actState     = useState(1);  var activity = actState[0]; var setAct = actState[1];
    var stageState   = useState(0);  var stage = stageState[0]; var setStage = stageState[1];
    var resultsState = useState(null); var results = resultsState[0]; var setResults = resultsState[1];
    var errState     = useState(""); var err = errState[0]; var setErr = errState[1];

    function switchUnit(u) {
      setUnit(u); setWeight(""); setHFt(""); setHIn(""); setHCm(""); setResults(null); setErr("");
    }

    function calc() {
      setErr("");
      var wKg, hCmV;
      if (unit === "imperial") {
        if (!weight || !hFt || !age) { setErr("Please fill in weight, height (ft), and age."); return; }
        wKg  = parseFloat(weight) * 0.453592;
        hCmV = (parseFloat(hFt) * 12 + parseFloat(hIn || 0)) * 2.54;
      } else {
        if (!weight || !hCm || !age) { setErr("Please fill in weight, height, and age."); return; }
        wKg  = parseFloat(weight);
        hCmV = parseFloat(hCm);
      }
      var ageV = parseFloat(age);
      if (wKg <= 0 || hCmV <= 0 || ageV <= 0) { setErr("Please enter valid numbers."); return; }

      var act = ACTIVITY[activity];
      var stg = STAGES[stage];

      var bmr  = 10 * wKg + 6.25 * hCmV - 5 * ageV - 161;
      var tdee = Math.round(bmr * act.mult);

      var pMin    = Math.round(stg.pm * wKg);
      var pMax    = Math.round((stg.pm + 0.2) * wKg);
      var protein = Math.round((pMin + pMax) / 2);
      var pCal    = protein * 4;

      var carbs = Math.round(act.ck * wKg);
      var cCal  = carbs * 4;

      var fat  = Math.round(Math.max(tdee - pCal - cCal, tdee * 0.25) / 9);
      var fCal = fat * 9;

      var tot  = pCal + cCal + fCal;
      var pPct = Math.round(pCal / tot * 100);
      var cPct = Math.round(cCal / tot * 100);
      var fPct = 100 - pPct - cPct;

      setResults({
        tdee: tdee, protein: protein, carbs: carbs, fat: fat,
        pCal: pCal, cCal: cCal, fCal: fCal,
        pPct: pPct, cPct: cPct, fPct: fPct,
        pMin: pMin, pMax: pMax,
        stageName: stg.label, pMult: stg.pm,
        pM: [
          { meal:"Breakfast",            amount: Math.round(protein * 0.30) },
          { meal:"Lunch",                amount: Math.round(protein * 0.30) },
          { meal:"Dinner",               amount: Math.round(protein * 0.30) },
          { meal:"Snack / Post-Workout", amount: Math.round(protein * 0.10) },
        ],
        cM: [
          { meal:"Breakfast", amount: Math.round(carbs * 0.30) },
          { meal:"Lunch",     amount: Math.round(carbs * 0.35) },
          { meal:"Dinner",    amount: Math.round(carbs * 0.25) },
          { meal:"Snack",     amount: Math.round(carbs * 0.10) },
        ],
        fM: [
          { meal:"Breakfast", amount: Math.round(fat * 0.30) },
          { meal:"Lunch",     amount: Math.round(fat * 0.30) },
          { meal:"Dinner",    amount: Math.round(fat * 0.30) },
          { meal:"Snack",     amount: Math.round(fat * 0.10) },
        ],
      });
    }

    return e("div", { style:{ minHeight:"100vh", padding:"20px" } },
      e("div", { style:{ maxWidth:"560px", margin:"0 auto" } },

        /* title */
        e("div", { style:{ textAlign:"center", marginBottom:"32px", paddingTop:"10px" } },
          e("div", { style:{ fontSize:"32px", marginBottom:"8px" } }, "\uD83C\uDF3F"),
          e("h1", { style:{ fontWeight:"700", color:"#3d2c24", fontSize:"26px", margin:"0 0 8px 0", lineHeight:"1.3" } },
            "Menopause Macro Calculator"),
          e("p", { style:{ color:"#8a7060", fontSize:"14px", margin:0, lineHeight:"1.6", fontStyle:"italic" } },
            "Protein, carbohydrate, and fat targets calibrated to your hormonal stage and activity level, based on female-specific exercise physiology research.")
        ),

        /* form */
        e("div", { style: cardStyle },

          /* unit toggle */
          e("div", { style:{ display:"flex", marginBottom:"24px", background:"#f5ebe0", borderRadius:"12px", padding:"4px" } },
            ["imperial","metric"].map(function(u) {
              return e("button", {
                key: u,
                onClick: function() { switchUnit(u); },
                style:{
                  flex:1, padding:"10px", border:"none", borderRadius:"10px", cursor:"pointer",
                  fontFamily:"'Libre Baskerville', serif", fontSize:"14px", fontWeight:"700",
                  background: unit === u ? "#c47c5a" : "transparent",
                  color:      unit === u ? "white"   : "#8a7060"
                }
              }, u === "imperial" ? "Imperial (lbs / ft)" : "Metric (kg / cm)");
            })
          ),

          /* weight + age */
          e("div", { style:{ display:"grid", gridTemplateColumns:"1fr 1fr", gap:"16px", marginBottom:"16px" } },
            e("div", null,
              e("label", { style: lblStyle }, "Weight (" + (unit === "imperial" ? "lbs" : "kg") + ")"),
              e("input", { style: inputStyle, type:"number", placeholder: unit === "imperial" ? "e.g. 145" : "e.g. 66",
                value: weight, onChange: function(ev) { setWeight(ev.target.value); } })
            ),
            e("div", null,
              e("label", { style: lblStyle }, "Age"),
              e("input", { style: inputStyle, type:"number", placeholder:"e.g. 48",
                value: age, onChange: function(ev) { setAge(ev.target.value); } })
            )
          ),

          /* height */
          e("div", { style:{ marginBottom:"16px" } },
            e("label", { style: lblStyle }, "Height"),
            unit === "imperial"
              ? e("div", { style:{ display:"flex", gap:"10px" } },
                  e("input", { style: inputStyle, type:"number", placeholder:"ft", value: hFt, onChange: function(ev) { setHFt(ev.target.value); } }),
                  e("input", { style: inputStyle, type:"number", placeholder:"in", value: hIn, onChange: function(ev) { setHIn(ev.target.value); } })
                )
              : e("input", { style: inputStyle, type:"number", placeholder:"e.g. 165 cm", value: hCm, onChange: function(ev) { setHCm(ev.target.value); } })
          ),

          /* stage */
          e("div", { style:{ marginBottom:"16px" } },
            e("label", { style: lblStyle }, "Hormonal Stage"),
            e("div", { style:{ display:"flex", flexDirection:"column", gap:"8px" } },
              STAGES.map(function(s, i) {
                return e(SelectOption, { key:i, label:s.label, desc:s.desc, selected:stage===i, accent:"#c47c5a", onClick:function() { setStage(i); } });
              })
            )
          ),

          /* activity */
          e("div", { style:{ marginBottom:"24px" } },
            e("label", { style: lblStyle }, "Activity Level"),
            e("div", { style:{ display:"flex", flexDirection:"column", gap:"8px" } },
              ACTIVITY.map(function(a, i) {
                return e(SelectOption, { key:i, label:a.label, desc:a.desc, selected:activity===i, accent:"#7a9e7e", onClick:function() { setAct(i); } });
              })
            )
          ),

          /* error */
          err ? e("div", { style:{ padding:"10px 14px", background:"#fff0ed", border:"1px solid #f4a0a0",
            borderRadius:"10px", fontSize:"13px", color:"#c04040", marginBottom:"16px" } }, err) : null,

          /* submit */
          e("button", {
            onClick: calc,
            style:{
              width:"100%", padding:"16px", border:"none", borderRadius:"14px", cursor:"pointer",
              background:"linear-gradient(135deg, #c47c5a, #a05c3a)", color:"white",
              fontSize:"16px", fontFamily:"'Libre Baskerville', serif", fontWeight:"700",
              boxShadow:"0 4px 20px rgba(160,92,58,0.35)"
            }
          }, "Calculate My Macros")
        ),

        /* results */
        results ? e("div", { className:"fade-in" },

          /* calorie banner */
          e("div", { style:{ background:"linear-gradient(135deg, #3d2c24, #6b4535)", borderRadius:"20px",
            padding:"24px", marginBottom:"16px", color:"white", textAlign:"center" } },
            e("div", { style:{ fontSize:"13px", opacity:0.7, marginBottom:"4px", fontStyle:"italic" } }, "Your daily calorie target"),
            e("div", { style:{ fontSize:"48px", fontWeight:"700", lineHeight:"1.1" } }, results.tdee.toLocaleString()),
            e("div", { style:{ fontSize:"13px", opacity:0.7, marginBottom:"20px" } }, "kcal / day"),
            e("div", { style:{ display:"grid", gridTemplateColumns:"1fr 1fr 1fr", gap:"12px" } },
              [["Protein", results.pPct+"%", "#f4a46a"],
               ["Carbs",   results.cPct+"%", "#82c4a0"],
               ["Fat",     results.fPct+"%", "#a8c4e4"]].map(function(row) {
                return e("div", { key:row[0], style:{ background:"rgba(255,255,255,0.1)", borderRadius:"12px", padding:"10px 6px" } },
                  e("div", { style:{ fontWeight:"700", fontSize:"18px", color:row[2] } }, row[1]),
                  e("div", { style:{ fontSize:"11px", opacity:0.7, marginTop:"2px" } }, row[0])
                );
              })
            )
          ),

          /* protein range note */
          e("div", { style:{ background:"#fff8f4", border:"1px solid #f0ddd0", borderRadius:"14px",
            padding:"14px 16px", marginBottom:"16px", fontSize:"13px", color:"#7a5a48", lineHeight:"1.6" } },
            e("strong", { style:{ color:"#c47c5a" } }, "Protein target range: "),
            results.pMin + " to " + results.pMax + "g per day, based on " +
            results.pMult.toFixed(1) + " to " + (results.pMult + 0.2).toFixed(1) +
            "g per kg of bodyweight for " + results.stageName.toLowerCase() + "."
          ),

          /* range bars */
          e("div", { style: Object.assign({}, cardStyle, { marginBottom:"16px" }) },
            e("div", { style:{ fontWeight:"700", color:"#3d2c24", marginBottom:"16px", fontSize:"15px" } }, "Daily Ranges"),
            e(RangeBar, { label:"Protein",       value:results.protein, unit:"g", min:results.pMin,                   max:results.pMax+10,                color:"#f4a46a" }),
            e(RangeBar, { label:"Carbohydrates", value:results.carbs,   unit:"g", min:Math.round(results.carbs*0.75), max:Math.round(results.carbs*1.3),  color:"#82c4a0" }),
            e(RangeBar, { label:"Fat",           value:results.fat,     unit:"g", min:Math.round(results.fat*0.8),    max:Math.round(results.fat*1.25),   color:"#a8c4e4" })
          ),

          /* macro cards */
          e("div", { style:{ display:"flex", flexDirection:"column", gap:"12px", marginBottom:"16px" } },
            e(MacroCard, { label:"Protein", grams:results.protein, calories:results.pCal, pct:results.pPct,
              color:"#e87c3c", emoji:"\uD83E\uDD5A", meals:results.pM,
              note:"Prioritize a high-protein breakfast. Distribute evenly across meals to trigger muscle protein synthesis at each eating occasion. Post-workout protein should be 40 to 60g within 45 minutes." }),
            e(MacroCard, { label:"Carbohydrates", grams:results.carbs, calories:results.cCal, pct:results.cPct,
              color:"#4a9e6a", emoji:"\uD83C\uDF3E", meals:results.cM,
              note:"Front-load carbs earlier in the day when insulin sensitivity is highest. Choose lentils, oats, sweet potato, berries, and whole grain sourdough over refined sources." }),
            e(MacroCard, { label:"Fat", grams:results.fat, calories:results.fCal, pct:results.fPct,
              color:"#4a7ca8", emoji:"\uD83E\uDD51", meals:results.fM,
              note:"Prioritize olive oil, avocado, fatty fish, eggs, and nuts. Replace seed oils with extra-virgin olive oil or avocado oil." })
          ),

          /* reminders */
          e("div", { style: Object.assign({}, cardStyle, { marginBottom:"24px" }) },
            e("div", { style:{ fontWeight:"700", color:"#3d2c24", marginBottom:"14px", fontSize:"15px" } }, "Key Reminders"),
            [
              ["\uD83D\uDEAB", "Do not skip breakfast. Fasted training raises cortisol and worsens menopausal symptoms."],
              ["\uD83D\uDCAA", "Post-workout protein should be 40 to 60g within 45 minutes to overcome anabolic resistance."],
              ["\uD83C\uDF3F", "Front-load both protein and carbohydrates earlier in the day for the best metabolic response."],
              ["\uD83C\uDF77", "Even one drink per day measurably impairs estrogen detoxification and worsens hot flashes and sleep."],
              ["\uD83D\uDD2C", "These targets are a research-based starting point. Adjust based on labs, symptoms, and how you feel."],
            ].map(function(row, i) {
              return e("div", { key:i, style:{ display:"flex", gap:"12px", padding:"10px 0",
                borderBottom: i < 4 ? "1px solid #f8f4f0" : "none", alignItems:"flex-start" } },
                e("span", { style:{ fontSize:"18px" } }, row[0]),
                e("span", { style:{ fontSize:"13px", color:"#6b5a4e", lineHeight:"1.6" } }, row[1])
              );
            })
          )

        ) : null,

        /* footer */
        e("div", { style:{ textAlign:"center", fontSize:"11px", color:"#b0a090", paddingBottom:"30px", fontStyle:"italic" } },
          "Based on published research in exercise physiology and female-specific sports nutrition, including the International Society of Sports Nutrition Female Athlete Position Stand. Not a substitute for individual clinical guidance.")

      )
    );
  }

  var root = ReactDOM.createRoot(document.getElementById("root"));
  root.render(e(App));
})();
</script>
</body>
</html>
